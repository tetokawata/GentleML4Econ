[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "データ分析入門ノート",
    "section": "",
    "text": "Preface",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#本ノートの狙い",
    "href": "index.html#本ノートの狙い",
    "title": "データ分析入門ノート",
    "section": "本ノートの狙い",
    "text": "本ノートの狙い\n初学者に対して、データ分析法、具体的な分析工程に埋め込みながら紹介します。 特に分析法の急速な多様化に対応するため、分析のゴールに応じた整理し、実践への活用における混乱を減らすことに重点を置きます。 具体的には、以下の点に注意して、本ノートは作成されています。\n\n２種類の分析のゴール、「新しい事例について欠損情報の予測を行う予測」と 「事例の集団についてその特徴を把握するための分析法」、を紹介します。 把握のための分析の具体例としては、比較分析を主に扱います。例えば男女間賃金格差や前年と比較した場合の不動産価格変化など、集団間で見られる違いを把握する方法を紹介します。\n平均値の推定やOLSといった計量経済学の入門書で紹介される伝統的な手法だけでなく、決定木やRandomForestといった教師付き学習(機械学習の一分野)の手法も議論します。 分析のゴールが予測モデルの推定であるならば機械学習に比較優位があり、集団の特徴を把握することが目標であるならば、伝統的な手法に比較優位があることを、その理由とともに強調します。 さらに発展的な比較をゴールとする場合、教師付き学習と伝統的な手法のハイブリット的な手法が有効であることも論じます。\n予測と把握という分析のゴールの使い分け方を、具体的な意思決定を想定しながら整理します。 データ分析の目的を、意思決定に役立つ情報提供にあると位置付け、意思決定の種類に応じた分析のゴールを論じます。特に限られた事例にのみ影響を与える意思決定 (ミクロな意思決定)と大量の事例に影響を与える意思決定 (マクロな意思決定)を区別します。 教師付き学習がもたらす事例ごとの予測は、ミクロな意思決定においては非常に有効であったとしても、マクロな意思決定においてはそのままでは活用が難しいことを強調します。これは大量の事例について提供される大量の予測値を、意思決定者が活用することが難しいためです。 マクロな意思決定においては、大量の事例群の特徴を把握が必要になり、このためには伝統的な手法が比較優位を持ちます。 ただし複雑な特徴を把握する上では、伝統的な手法と教師付き学習のハイブリット的な手法が有効になることを強調します。",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#ノートの背景",
    "href": "index.html#ノートの背景",
    "title": "データ分析入門ノート",
    "section": "ノートの背景",
    "text": "ノートの背景\n本ノート作成の背景には、データ分析法の多様化とそれに伴う混乱があります。 データを用いた社会分析は、長い伝統を持ちます。 例えば経済学においては、古くからデータ分析が活用され、計量経済学と呼ばれる方法論開発を行う研究分野には多くの研究者が参入し、活発な議論が行われてきました。 また実際にデータを用いて行う実証研究も数多く行われ、伝統的にはOLSなどのモーメント法や最尤法などを用いたデータ分析が行われてきました。\n近年、コンピュータの計算能力増大などを背景に、伝統的な分析手法のみならず、機械学習と総称される分析手法の活用が急速に進んでいます。 特に教師付き学習と呼ばれる分野は、経済学における伝統的な推定手法と近い手法や問題意識を有しつつ、データの柔軟な活用方法を提供しています。 例えば、教師付き学習の教科書では、ほぼ例外なくLogitやOLSは紹介され、母分布を用いた論点整理がなされています。 他方で計量経済学の入門書ではあまり紹介されてこなかった、Data adaptive modellingの手法が数多く提案されています。 伝統的な推定手法が、「人間によってシンプルな 推定モデルの設定を行い、その限られたパラメタをデータにより推定する」という手続きを踏むのに対して、決定木やLASSOは、「大量のパラメタを、データによる適切に推定する」方法です。\nこのような分析方法の多様化は、同時に応用研究における混乱ももたらしえます。例えば Breiman (2001) は、伝統的な統計学の95 \\(\\%\\) と機械学習では、異なる”文化”を持っていると主張し、多くの議論を想起しました。 このような議論 (Shmueli 2010; Efron 2020; Hofman et al. 2021)の中で、分析のゴールをしっかり意識することの重要性が指摘され、ゴールによっては伝統的な手法と機械学習のハイブリット的な方法の有効性が指摘されています(Van der Laan, Rose, et al. 2011; Chernozhukov et al. 2018, 2022)。\nこのような研究の成果は、上級レベルの計量経済学のテキストでは紹介され、またChernozhukov et al. (2024)などで集中的にまとめられています。 しかしながら、現状入門的な日本語の教材は見当たりません。 本ノートは、この空白を埋めることを目的としています。",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#章立て",
    "href": "index.html#章立て",
    "title": "データ分析入門ノート",
    "section": "章立て",
    "text": "章立て\n\nSection 1  分析工程\nSection 2  意思決定問題\nSection 3  要約の基本コンセプト\nSection 4  予測モデルの推定\nSection 5  単純な比較分析\nSection 6  複雑な比較分析",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#reference",
    "href": "index.html#reference",
    "title": "データ分析入門ノート",
    "section": "Reference",
    "text": "Reference\n\n\n\n\nBreiman, Leo. 2001. “Statistical Modeling: The Two Cultures (with Comments and a Rejoinder by the Author).” Statistical Science 16 (3): 199–231.\n\n\nChernozhukov, Victor, Denis Chetverikov, Mert Demirer, Esther Duflo, Christian Hansen, Whitney Newey, and James Robins. 2018. “Double/debiased machine learning for treatment and structural parameters.” The Econometrics Journal 21 (1): C1–68. https://doi.org/10.1111/ectj.12097.\n\n\nChernozhukov, Victor, Juan Carlos Escanciano, Hidehiko Ichimura, Whitney K Newey, and James M Robins. 2022. “Locally Robust Semiparametric Estimation.” Econometrica 90 (4): 1501–35.\n\n\nChernozhukov, Victor, Christian Hansen, Nathan Kallus, Martin Spindler, and Vasilis Syrgkanis. 2024. “Applied Causal Inference Powered by ML and AI.” arXiv Preprint arXiv:2403.02467.\n\n\nEfron, Bradley. 2020. “Prediction, Estimation, and Attribution.” International Statistical Review 88: S28–59.\n\n\nHofman, Jake M, Duncan J Watts, Susan Athey, Filiz Garip, Thomas L Griffiths, Jon Kleinberg, Helen Margetts, et al. 2021. “Integrating Explanation and Prediction in Computational Social Science.” Nature 595 (7866): 181–88.\n\n\nShmueli, Galit. 2010. “To Explain or to Predict?” Statistical Science 25 (3): 289–310.\n\n\nVan der Laan, Mark J, Sherri Rose, et al. 2011. Targeted Learning: Causal Inference for Observational and Experimental Data. Vol. 4. Springer.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "stracture.html",
    "href": "stracture.html",
    "title": "1  分析工程",
    "section": "",
    "text": "1.1 分析例",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>分析工程</span>"
    ]
  },
  {
    "objectID": "stracture.html#分析例",
    "href": "stracture.html#分析例",
    "title": "1  分析工程",
    "section": "",
    "text": "1.1.1 データ\n本ノートにおいてデータ分析法は、「事例から学ぶ方法」として位置付けます。 事例とは、過去の経験や出来事、歴史などであり、その蓄積をデータと呼びます。 例えば以下は、2021年と2022年の第二四半期の東京23区における中古マンション取引事例1をデータ化しています。\n\n\n\n\n\n\n\n\nPrice\nSize\nTradeYear\nStationDistance\nDistrict\nLargeDistrict\n\n\n\n\n24\n45\n2022\n9\n葛飾区\nその他\n\n\n61\n45\n2021\n8\n新宿区\n中心6区\n\n\n46\n50\n2021\n4\n中央区\n中心6区\n\n\n80\n55\n2022\n8\n目黒区\nその他\n\n\n60\n55\n2021\n11\n港区\n中心6区\n\n\n36\n30\n2021\n11\n江東区\nその他\n\n\n40\n60\n2021\n15\n世田谷区\nその他\n\n\n68\n80\n2021\n8\n葛飾区\nその他\n\n\n48\n65\n2021\n5\n世田谷区\nその他\n\n\n20\n20\n2022\n11\n足立区\nその他\n\n\n\n\n\n\n\n以上のような取引事例が 6378 個収録されています。 このようなデータを用いて、以下のような意思決定問題に役立つ情報提供のあり方を、ラフに論じます。\n\n\n1.1.2 中古マンション取引価格の予測\n東京２３区内の中古マンションの取引価格を、\\(\\{\\)取引された物件の築年数 (Tenure)、 部屋の広さ (Size)、駅からの距離 (Distance to Station)、立地 (District) \\(\\}\\) から予測するモデルを推定し、予測値を算出しました。\n\n\n\n\n\n\n\n\nPrediction\nSize\nStationDistance\nTenure\nDistrict\n\n\n\n\n21.56\n50\n4\n33\n葛飾区\n\n\n35.17\n45\n9\n36\n世田谷区\n\n\n73.68\n55\n6\n9\n新宿区\n\n\n46.80\n70\n13\n21\n墨田区\n\n\n20.27\n20\n6\n14\n墨田区\n\n\n25.53\n20\n8\n6\n豊島区\n\n\n60.13\n75\n5\n17\n大田区\n\n\n31.48\n35\n3\n51\n港区\n\n\n10.39\n30\n6\n48\n板橋区\n\n\n29.35\n40\n6\n19\n板橋区\n\n\n251.91\n115\n5\n6\n港区\n\n\n\n\n\n\n\n\n\n1.1.3 中古マンション市場の動向\n2022年と2021年の東京23区内の中古マンション市場を比較しました。\n\n2022-2021年比較: \\(\\{\\) Tenure, Size, Distance to Station \\(\\}\\)の差を95\\(\\%\\) 信頼区間 (Bonferoni法による修正済み)を表示\nバランス前-後平均取引価格上昇率: 取引価格の対数値について、2022年と2021年の単純平均差 (Difference-in-means) および、「\\(\\{\\)取引された物件の築年数 (Tenure)、 部屋の広さ (Size)、駅からの距離 (Distance to Station) \\(\\}\\) の分布が変化しなかった」という仮想シナリオのもとでの取引価格の平均差 (What if 分析) を信頼区間とともに表示\n5区 (中心6区: \\(\\{\\)中央/千代田/港/新宿/渋谷/本郷\\(\\}\\)、 北部: \\(\\{\\)北/板橋/豊島\\(\\}\\) 、南部: \\(\\{\\)品川/目黒/大田 \\(\\}\\) 、西部: \\(\\{\\)世田谷/中野/杉並/練馬 \\(\\}\\) 、 東部: \\(\\{\\) 台東/墨田/江東/葛飾/江戸川 \\(\\}\\))、 別の平均取引価格の上昇率 (物件の特徴はバランス済み)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>分析工程</span>"
    ]
  },
  {
    "objectID": "stracture.html#詳細な工程",
    "href": "stracture.html#詳細な工程",
    "title": "1  分析工程",
    "section": "1.2 詳細な工程",
    "text": "1.2 詳細な工程\n想定する具体的なデータ分析の工程は以下です。\n\n\n\n\n\n\n\n\n\n\nQ\n直面する意思決定問題\n\n\n\nUnderstand\n把握を目的とする要約\n\n\n\nQ-&gt;Understand\n\n\n\n\n\nPrediction\n予測を目的とする要約\n\n\n\nQ-&gt;Prediction\n\n\n\n\n\nStat\n伝統的な手法\n\n\n\nUnderstand-&gt;Stat\n\n\n\n\n\nML\n教師付き学習\n\n\n\nPrediction-&gt;ML\n\n\n\n\n\nPredModel\n予測モデル\n\n\n\nEstimand\nシンプルな特徴把握\n\n\n\nStat-&gt;Estimand\n\n\n\n\n\nDML\n複雑な特徴把握 (What if 分析)\n\n\n\nStat-&gt;DML\n\n\n\n\n\nML-&gt;PredModel\n\n\n\n\n\nDML-&gt;ML\n\n\n\n\n\n\n\n\n\n\nまず現在必要とされている意思決定問題を明確化します。 次にその意思決定問題に有益な情報を明確にすることで、分析のゴールを設定します。 ここでは大きく予測を目的とする研究と集団の特徴把握を目標とする研究に大別し論じます。 次にそれぞれのゴールに適した手法を用いた推定を行い、分析結果を得ます。 ここでは予測を目標とする研究であれば教師付き学習の手法、把握を目標とするのであれば伝統的な手法、より複雑な特徴を把握したいのであればそのハイブリット的な方法に比較優位があることを論じます。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>分析工程</span>"
    ]
  },
  {
    "objectID": "stracture.html#footnotes",
    "href": "stracture.html#footnotes",
    "title": "1  分析工程",
    "section": "",
    "text": "国土交通省のレポジトリ (https://www.reinfolib.mlit.go.jp/) からダウンロードできます。↩︎",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>分析工程</span>"
    ]
  },
  {
    "objectID": "decision.html",
    "href": "decision.html",
    "title": "2  意思決定問題",
    "section": "",
    "text": "データ分析を始めるための最初のステップは、分析結果をどのように活用するのか、明確なイメージを持つことです。 活用方法に応じて、適した分析のゴール、ひいては分析方法も異なってきます。\n本ノートでは、何らかの意思決定問題の改善への活用を目指して行うデータ分析を想定します。 一般に意思決定において、多くの情報が必要となります。 そしてそのような情報の多くは、直接観察することはできず、過去の経験や事例から類推するしかありません。 具体例として、二つの意思決定問題を考え、これらの意思決定を支援するために、@(のデータの活用を目指すとします?)。 便宜上、一番目の意思決定をミクロな意思決定、二番目をマクロな意思決定と呼びます。\n\n(ミクロな意思決定) 中古マンションの買取: 不動産業者が、ある中古マンションを適正価格で買取を行おうとしている。この際にこの物件の市場価格を参照したいが、分からない。\n(マクロな意思決定) 支店網の見直し: 大規模な不動産会社が、都内の支店網の見直し計画を策定しようとしている。この際に、足元の不動産市場の状況を参照したいが、分からない。\n\nミクロな意思決定については、予測値 @@ は有益なものになるかもしれません。 予測性能が良ければ、買取査定において重要となる現状での市場価格を物件(事例)ごと に算出できます。\n対してマクロな意思決定については、予測値そのものの持つ意義は限定的です。 大量の予測値を一度に見せられても、人間が処理しきれず、判断に活用できないためです。 大量の取引物件(事例)の特徴 を、人間が把握するためには、より情報を要約する必要があり、@(のような把握を目的とした結果が比較優位を有するかもしれません?)。\n本ノートにおいて、ミクロな意思決定は限られた数の事例についてのみ影響を与えるような意思決定を指します。 例えば、ある物件の買取が、他の物件に与える直接的な影響は限定的かもしれません。 一般に機械学習を用いた予測モデルの優れた実践例は、ミクロな意思決定の支援、あるいは自動化が多いです。 例えば、迷惑メールの自動分類が古典的な例となります。 このように影響を与える事例数が限られており、事例に合わせた意思決定が要求される場合、事例ごとに予測値を算出することには、大きな意義があります。\nマクロな意思決定は、多くの事例に一度に影響を与えるような意思決定を指します。 政府による政策決定や企業の戦略決定、あるいは有権者による投票行動などが含まれます。 影響を与える事例数が膨大なものとなる場合、個々の事例把握は困難であり、事例群全体の特徴を把握する方が現実的です。 このような場合は、伝統的な推定方法、あるいは機械学習とのハイブリット的な方法が比較優位を持つと考えられます。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>意思決定問題</span>"
    ]
  },
  {
    "objectID": "model.html",
    "href": "model.html",
    "title": "3  要約の基本コンセプト",
    "section": "",
    "text": "3.1 観察できない変数が引き起こす問題\nデータから観察できない(研究者が知覚出来ない)変数の存在は、あらゆる事例分析の最も深刻な問題の一つです。 このような変数への対処について、膨大な議論が蓄積されています。\n観察できない変数がもたらす問題は、個別事例分析において、顕著です。 今、取引価格 \\(=Y\\) と物件の特徴 \\(=X\\) の関係性を把握するために、個別事例を丹念に見ていきます。 例えば、以下の2億円で取引されている物件が、データの中に含まれていました。\nPrice\nSize\nTradeYear\nLargeDistrict\n\n\n\n\n200\n105\n2022\n中心6区\nこの事例から、部屋の広さが105平米で中心6区(港、中央、千代田、新宿、渋谷、文教)に立地する物件は、2億円で取引される傾向があったと結論づけても良いでしょうか？ ほとんどの応用でこのような推測は、不適切です。 実際に同じデータの中に、取引価格以外全く同じ特徴を持つ物件の取引事例が、以下の3件ありました。 これらの事例と比較すると、2億円はかなり高い価格での取引だったことがわかります。\nPrice\nSize\nTradeYear\nLargeDistrict\n\n\n\n\n200\n105\n2022\n中心6区\n\n\n150\n105\n2022\n中心6区\n\n\n92\n105\n2022\n中心6区\n\n\n110\n105\n2022\n中心6区\nなぜこのような取引価格のブレが生じるのでしょうか？ データの誤入力など潜在的な理由は複数ありますが、有力なのはこのデータに含まれない重要な変数 が存在することです。 例えば、最寄駅や公園の近くにあるか否かなどのより詳細な立地情報が考えられます。 あるいは売り手や買い手の”交渉力”を反映している可能性もあります。 このような多様な要因が、取引価格に影響を与え、結果として事例の下振れ/上振れが生じます。\n観察できない変数は不動産のみならず、労働者や家計、企業、あるいは国レベルの分析でも同様の問題を引き起こします。 観察できる変数 \\(X\\) が一致した事例内でも、観察できない変数は事例間で大きく異なっている可能性が高く、結果 \\(Y\\) の値に大きな差が生まれます。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "model.html#観察できない変数が引き起こす問題",
    "href": "model.html#観察できない変数が引き起こす問題",
    "title": "3  要約の基本コンセプト",
    "section": "",
    "text": "3.1.1 集計\n先の個別事例分析では、観察できない変数 \\(X\\) の偏りを確認する方法として、同じ\\(X\\)を持つ事例と比較しました。 このようなアプローチの発展として、同じ\\(X\\)を持つ事例集団における \\(Y\\) の代表的な値を算出する方法があります。 代表的な値の候補としては、中央値や最頻値など多くの候補があります。 中でもよく用いられるのは、平均値です。\n以下では、価格 (Price) と広さ (Size)、立地 (中心6区/その他)、取引年 (2021/2022)について、データに含まれる事例の分布をHeat mapで図示しています。\n\n\n\n\n\n\n\n\n\n上記の散布図は、社会分析に用いるデータの持つ典型的な特徴を表しています。 極めて乱雑であり、同じ\\(X\\) でも \\(Y\\) が異なる事例が多くなっています。 これは、観察できない変数の偏りが深刻である可能性を示唆しています。 また \\(X\\) の値に応じた事例数の偏りも顕著であり、特に100平米を超えるような物件の取引事例は少なくなっています。\n以下の図は、各\\(X\\)の組み合わせごとに計算された平均値を図示しています。\n\n\n\n\n\n\n\n\n\n同図からは、\\(Y\\) と \\(X\\) のデータ上の関係性について、いくつか示唆を与えてます。 部屋が広くなると取引価格は高くなる傾向があり、この傾向は中心6区で特に顕著となります。\n多くの応用でこのような\\(X\\)ごとに集計するだけでは、不十分です。 例えば平均値を算出するために使用される事例数が、特に100平米を超える物件について少なくなっていることに注目してください。 仮に平均値を計算するとしても、事例数が少ないと、各事例の観察できない変数の偏りの影響を強く受ける可能性があります。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "model.html#観察できない事例が引き起こす問題",
    "href": "model.html#観察できない事例が引き起こす問題",
    "title": "3  要約の基本コンセプト",
    "section": "3.2 観察できない事例が引き起こす問題",
    "text": "3.2 観察できない事例が引き起こす問題\n少数事例の集計が引き起こす問題を理解するために、頻度論と呼ばれる枠組みを導入します。 具体的なイメージを持つために、「自分と同じ課題に取り組む、他の研究者達」を想像してください。 この研究者は、あなたと同じ社会を対象に同じ手法を用いて分析しています。 ただしデータは、独立して収集しているとします。 このような研究者達は、あなたと同じ分析結果に到達するでしょうか？\n一般に独立した研究者は、同じ結論に到達しえません。 なぜならば、分析に用いる事例が異なるためです。 ほとんどの応用で、独立して収集したデータが、完全に一致する可能性は無視できるほど小さくなるでしょう。 すなわちある研究者が観察した事例を、別の研究者は観察できない可能性が高いのです。\n分析結果の不一致の典型例としては、報道機関による世論調査が挙げられます。 複数の調査結果が、毎月公開されていますが、その結果は各社で異なっています。 理由は複数考えられますが、最も単純なものは、調査対象となる回答者が異なるためです。 典型的な世論調査では、各社が独立して電話番号をランダムに発生させるなどの方法で、1000-2000名ほどの回答者を極力ランダムに選んでいます。 このため、異なる調査に同じ人が回答する確率は低くなります。 さらに回答者全員が全く同じになる確率は、無視できるほど小さいものになります。\n観察できない事例の存在は、観察できない変数の偏りをもたらします。 ある研究者には、偶然、公園に近い物件の取引事例ばかり集まってくるかもしれません。 このような研究者のデータで計算された取引価格の平均値は、他の研究者と比べて、上振れる可能性が高いです。 すなわち要約した値であったとしても、研究者間で同じ値に合意できなくなります。\n事例研究において、人々が同じ結果を観察できない、という問題は深刻です。 なぜならば、「独立した個人や組織が同じ結果を観察できる」、ので推定結果を事実(ファクト)として認定する、というシンプルかつ強力な枠組みが活用できません。\nことは再現可能性と呼ばれ、結果を事実（ファクト）として認定する基本的な要求になっています。 この問題に対処するためには、何らかの概念的な枠組みが必要となります。\n\n3.2.1 母分布とサンプリング\n観察できない事例の問題と、それに伴う分析結果の不一致の問題に対処するために、母分布という分析概念を導入します。 母集団を導入することで、共通の正答と各々のデータから得られる回答が、分離して定義できます。\n「私たちが手にしているデータは、母集団という無数の事例の集団から、選ばれた事例から構成されている」と 想定 します。 さらに本ノートでは、事例は完全ランダムに選ばれていると仮定します。 このような仮定をランダムサンプリングと呼びます。 私たちが得られる回答は、このランダムに選ばれた一部の事例のみから得たものであり、正答とは一致しません。\n母集団とサンプリングの例として、労働力調査が挙げられます。 労働力調査は毎月総務省により実施されている世帯を対象とした調査です。 回答対象となる世帯は、日本の世帯全体からランダムに選ばれています。 このため労働力調査の母集団は、日本の世帯全体と見做せます。\n母集団として、仮想的な集団を想定することもできます。 例えば、あるコンビニのレジデータに、ある日の全ての来客者について、購入金額が全て記録されているとします。 この場合、現実の来客者全てが記録されているため、母集団は存在しないと考えることも可能です。 一方で、その日にコンビニを訪れた顧客は、潜在的な顧客の一部であると想定することもできます。 皆さんも、よく利用するコンビニであったとしても、毎日利用しないのではないでしょうか？ この場合の母集団は、潜在的な顧客となります。\n母集団を想定すると、母集団における変数の分布も定義できます。 例えば、「取引物件の母集団において、中心6区に立地する物件の割合は2割」、といった感じです。 また母分布を定義できれば、そこから母集団における平均値(母平均)も定義できます。 平均値の推定を目指す研究であれば、この母平均が正答となります。 例えば、「中心6区に立地する50平米の中古マンションの2022年における平均取引価格は5000万円」、といった感じです。\n何を正答するかは、推定対象、ひいては活用したい意思決定問題に応じて、人間が適切に設定する必要があります。 本ノートは、多くの予測/社会の把握を目的とした分析において、母平均は正答となることを論じます。 同時に、データから回答を得る方法は、目的に応じて大きく異なることも強調します。\n厳重に注意が必要なのは、「我々には母分布や母平均を正確に知ることは不可能である」ことがデータ分析法の前提である点です。 知ることができない母分布や母平均を、手元にある限られたデータから、以下に推測するのかが、データ分析の中心的な挑戦となります。 データが母集団の一部であり、観察できていない事例が存在する以上、データ上の平均値と母平均は一致しません。 またデータはランダムに選ばれているので、独立した研究者間で、平均値について厳密な合意はできません。\n母集団は、研究課題と研究対象となる社会が定まれば、唯一の正答を定義します。 そしてサンプリングを通じて、異なる回答が生じることも記述します。 例えば、「真実は人の数だけある」という立場もその一つです。 もし同じ結果に合意できないのであれば、データ分析は何を人によって答えが異なることを認めて良いのか？？",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "model.html#数値例",
    "href": "model.html#数値例",
    "title": "3  要約の基本コンセプト",
    "section": "3.3 数値例",
    "text": "3.3 数値例\n以上の概念を明確にするために、簡単な数値実験を行います。 今、4名の研究者が独立して20事例を集めたとします。 各事例について、取引価格 \\(Y\\) と 部屋の広さ \\(X\\in\\{40,50,60,70\\}\\) がデータから観察できるとします\n母分布は以下のように設定しています。\n\n部屋の広さは、\\(X=40\\) は \\(10\\%\\)、 残りは \\(30\\%\\)\n取引価格は、\n\n\\(X=70\\) であれば、7から13の範囲に同じ割合で分布\n\\(X=\\{40,50,60\\}\\) であれば、8から14の範囲に同じ割合で分布\n\n\n以下の図は、4名の研究者が手にするデータと平均値を図示しています。\n\n\n\n\n\n\n\n\n\n平均値について、研究者間で大きな違いが見られます。 例えば研究者1について、取引価格は部屋の広さに応じて、常に増加してます。 対して、研究者4については、一貫した傾向は見られません。 研究者3については、他と比べて、部屋の広さが40の平均取引価格が、他と比べて顕著に低くなっています。 これは事例数が少ない傾向にあるため、観察できない変数のばらつきが、平均値により強く影響を与えているためです。\nこの図に母平均を上書きすると以下のようになります。 ただし図を簡略化するために、各事例の値は排除します。\n\n\n\n\n\n\n\n\n\n重要な点として以下を確認してください。\n\n母平均は全員共通だが、データ上の平均値は異なる\n母平均とデータ上の平均は乖離している\n事例数が少ない\\(X=40\\)において、特に乖離幅が大きい傾向にある",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "model.html#母平均のモデル",
    "href": "model.html#母平均のモデル",
    "title": "3  要約の基本コンセプト",
    "section": "3.4 母平均のモデル",
    "text": "3.4 母平均のモデル\n観察できない変数と事例の問題は、母平均の推定を困難にします。 データ上の平均値は、事例数が減ると、母平均と大きく乖離する可能性が高くなります。 このため\\(X\\) の数が増えると、母平均の推定は非常に困難です。\n本ノートでは、この問題への対処として、母平均の”近似モデル”を推定するアプローチを紹介していきます。 例えば、先の数値例において、以下の手順化で近似モデル(グループ別平均モデル)を推定します。\n\n部屋の広さ が 50平米以下かどうかでサブグループを分けする\n各サブグループについて、平均値を計算し、 \\(Y\\) の近似モデル\n\n\n\n\n\n\n\n\n\n\n数値例は、グループ別平均モデルの利点と潜在的な欠点を示しています。 大きな利点は、研究者間で推定結果のバラツキが削減される点です。 特に研究者3が直面していた、部屋の広さが40のグループにおける推定値の母平均からの大きな乖離の問題が解消されています。 これは部屋の広さが40と50の事例を集計し、平均値を計算しているので、観察できない変数の偏りの影響を削減できるためです。\n潜在的な欠点は、部屋の広さが60の事例について、顕著に表れています。 \\(X=60\\) において、グループ別平均値は、母平均から乖離しています。 さらにこの乖離は、平均と比べて、大きくなる傾向が見られます。 これはモデルの設定に起因しています。 母平均において、平均取引価格は70平米とそれ以外で異なっています。 対して、この数値例で設定したモデルでは、60平米以上か以下で異なることしか許容していません。 このためこのモデルを用いる限り、どれだけ事例数が増えたとしても、母平均を正確に近似することは不可能です。\n本ノートを読む上で、注意が必要なのは、上記の欠点はあくまで潜在的なものである点です。 もし\\(Y\\)の予測を問題にするのであれば、人間による設定に起因する母平均とモデルの乖離は深刻な問題です。 この問題を解決するために、人間による設定の必要性を減らし、よりデータ主導でモデルを推定する方法が提案されています。 特に機械学習は、Random ForestやLASSO, Deep learningなどの多くの優れた方法を提案しており、予測を目的とする研究で幅広く用いられています。\n対して不動産市場の把握を目的とする研究では、問題にならないケースがあります。 例えば、二人暮らし向けの中古マンションと三人暮らし向けの中古マンションの特徴の違いを把握したいとします。 国土交通省が提示する誘導居住面積水準によると、二人暮らしにおいて望まれる部屋の広さの水準は55平米です。 これに照らし合わせて、50平米以下か以上にグループ分けを行い、その平均値を比較することは、極めて有効なデータ分析です。\n分析課題や何らかの外部基準に基づいて、データ分析を始める前にグループ分けを事前決定する方法には、大きな利点があります。 ある程度の事例数を含むランダムサンプリングデータであれば、データ上のグループ別平均値と母平均との間に、関係性が生じます1。 この関係性を利用することで、分析事例が、母平均の一部に過ぎないという問題に対して、推定の精度を定量的に示すという改善策を用いることができます。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "model.html#footnotes",
    "href": "model.html#footnotes",
    "title": "3  要約の基本コンセプト",
    "section": "",
    "text": "中心極限定理↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>要約の基本コンセプト</span>"
    ]
  },
  {
    "objectID": "prediction.html",
    "href": "prediction.html",
    "title": "4  予測モデルの推定",
    "section": "",
    "text": "4.1 モデル化",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#モデル化",
    "href": "prediction.html#モデル化",
    "title": "4  予測モデルの推定",
    "section": "",
    "text": "4.1.1 サブグループ平均\nこのような事例数の少なさに対応する方法として、分析者が事例をいくつかのサブグループへ事前に分類し、サブグループごとに平均値を計算する方法があります。 具体的には以下の分析工程を実行します。\n\n分析者が、サブグループ (モデル) を定義する\n\n\n例: 中心6区かどうか \\(\\times\\) 部屋の広さが75以下か否か\n\n\nサブグループの平均値を計算\n\nこのように推定された要約モデルは、以下のように図示できる。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4.1.2 Data-adaptive なサブグループ平均\n\n決定木アルゴリズム: データに最も適合するように、サブグループを定義する\n\n明確な基準(“データへの適合”)のもとで、要約方法を決定\n\n例. 最大４グループに分けることは前提に、平均二乗誤差 \\[(Y - モデルの予測値)^2のデータ上での平均値\\] を可能な限り削減するようにグループ分けを行う\n\n近似的に削減する (Greedy-algorithm)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4.1.3 よりData-adaptiveな決定木",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#現実",
    "href": "prediction.html#現実",
    "title": "4  予測モデルの推定",
    "section": "4.2 現実",
    "text": "4.2 現実\n\n\n\n\n\n\n\n\n\n\nX\nX\n\n\n\nf_Y\n「未知の」メカニズム\n\n\n\nX-&gt;f_Y\n\n\n\n\n\nY\nY\n\n\n\nf_Y-&gt;Y",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#ml",
    "href": "prediction.html#ml",
    "title": "4  予測モデルの推定",
    "section": "4.3 ML",
    "text": "4.3 ML\n\n\n\n\n\n\n\n\n\n\nX\nX\n\n\n\nf_Y\n「未知の」メカニズム\n\n\n\nX-&gt;f_Y\n\n\n\n\n\ng_Y\n複雑なモデル\n\n\n\nX-&gt;g_Y\n\n\n\n\n\nY\nY\n\n\n\nf_Y-&gt;Y\n\n\n\n\n\nf_Y-&gt;g_Y\n\n\n近似\n\n\n\ng_Y-&gt;Y\n\n\n\n\n\nEst\n推定\n\n\n\ng_Y-&gt;Est",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#getting-started",
    "href": "prediction.html#getting-started",
    "title": "4  予測モデルの推定",
    "section": "4.4 Getting Started",
    "text": "4.4 Getting Started",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#アイディア",
    "href": "prediction.html#アイディア",
    "title": "4  予測モデルの推定",
    "section": "4.5 アイディア",
    "text": "4.5 アイディア\n\n過去の \\(Y-X\\) の間の定量的なパターンを、データから抽出し、予測に利用する\n\n「1平米広い部屋は100万円高い価格で取引されがち」など\n\nそのデータ上にのみ偶然現れたパターンに注意する\n\n\n予測の対象となる新しい事例と過去の事例(データ)との間に、一貫性が必要",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#データ分割による評価",
    "href": "prediction.html#データ分割による評価",
    "title": "4  予測モデルの推定",
    "section": "4.6 データ分割による評価",
    "text": "4.6 データ分割による評価\n\n予測モデルの性能をどのように評価するか\n\n実際に実装し、運用すれば、そのうち性能がわかるが…\n\n遅すぎる場合も多い\n\n\nデータをランダム２分割(Training/Test)に分割し、Trainingデータのみでモデルを作り、Testで評価する\n典型的には、Testデータについて、平均二乗誤差 \\[(Y - 予測値)^2の平均値\\]",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#イメージ",
    "href": "prediction.html#イメージ",
    "title": "4  予測モデルの推定",
    "section": "4.7 イメージ",
    "text": "4.7 イメージ\n\n\n\n\n\n\n\n\n\n\nOriginal\nデータ\n\n\n\nData\n訓練データ {Y,X}\n\n\n\nOriginal-&gt;Data\n\n\nランダム分割\n\n\n\nNew\nテストデータ {Y,X}\n\n\n\nOriginal-&gt;New\n\n\n\n\n\nModel\n予測モデル g(X)\n\n\n\nData-&gt;Model\n\n\n推定\n\n\n\nNew-&gt;Model\n\n\n\n\n\nPredict\n予測値 Y^*\n\n\n\nModel-&gt;Predict\n\n\n\n\n\nPredict-&gt;New\n\n\nテスト",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#典型的誤解",
    "href": "prediction.html#典型的誤解",
    "title": "4  予測モデルの推定",
    "section": "4.8 典型的誤解",
    "text": "4.8 典型的誤解\n\n機械学習を用いて推定すれば、予測性能が高いモデルが獲得できる\n複雑な現象を予測するためには、複雑なモデルの方が望ましい\nBig dataを用いれば、理想的な予測モデルを推定できる\n予測性能が悪いモデルは、役に立たない",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#母集団を用いた整理",
    "href": "prediction.html#母集団を用いた整理",
    "title": "4  予測モデルの推定",
    "section": "4.9 母集団を用いた整理",
    "text": "4.9 母集団を用いた整理\n\n母集団: 論点整理を目的とした概念",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#母集団",
    "href": "prediction.html#母集団",
    "title": "4  予測モデルの推定",
    "section": "4.10 母集団",
    "text": "4.10 母集団\n\n手元のデータに含まれる事例は、母分布(集団)から抽出されたと想定する\n\n本講義では、ランダムに選ばれるケースに集中する\n\nRandom Sampling\n\n予測対象も、母分布からランダムに選ばれるとする\n\n一般にデータと母分布は、完全一致しない",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#例",
    "href": "prediction.html#例",
    "title": "4  予測モデルの推定",
    "section": "4.11 例",
    "text": "4.11 例\n\nユーザーの需要調査(どのようなサービスを望むか)\n\nデータ: サービス利用者の中からランダムに選ばれた200名 (例: 20代が2割)\n\n母集団: 全サービス利用者 (例: 20代が2.2割)\n予測対象: \\(X\\) (年齢など)のみ判明している利用者\n\n\n不動産取引価格の予測モデル\n\nデータ: 2022年第二四半期のすべての取引事例\n\n母集団: 潜在的な全取引\n予測対象: まだ取引されていない物件",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#イメージ-1",
    "href": "prediction.html#イメージ-1",
    "title": "4  予測モデルの推定",
    "section": "4.12 イメージ",
    "text": "4.12 イメージ\n\n\n\n\n\n\n\n\n\n\nPopulation\n母集団: 無数の事例 {Y,X}\n\n\n\nData\nデータ {Y,X}\n\n\n\nPopulation-&gt;Data\n\n\nランダム抽出\n\n\n\nNew\n新しい事例 {?,X}\n\n\n\nPopulation-&gt;New\n\n\n\n\n\nModel\n予測モデル g(X)\n\n\n\nData-&gt;Model\n\n\n\n\n\nNew-&gt;Model\n\n\n\n\n\nPredict\n予測値 Y^*\n\n\n\nModel-&gt;Predict",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-データ",
    "href": "prediction.html#数値例-データ",
    "title": "4  予測モデルの推定",
    "section": "4.13 数値例: データ",
    "text": "4.13 数値例: データ",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-予測モデル",
    "href": "prediction.html#数値例-予測モデル",
    "title": "4  予測モデルの推定",
    "section": "4.14 数値例: 予測モデル",
    "text": "4.14 数値例: 予測モデル",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-予測モデル-1",
    "href": "prediction.html#数値例-予測モデル-1",
    "title": "4  予測モデルの推定",
    "section": "4.15 数値例: 予測モデル",
    "text": "4.15 数値例: 予測モデル",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-予測モデルと母平均",
    "href": "prediction.html#数値例-予測モデルと母平均",
    "title": "4  予測モデルの推定",
    "section": "4.16 数値例: 予測モデルと母平均",
    "text": "4.16 数値例: 予測モデルと母平均\n\nここから想像の世界",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#不透明性-uncertainly",
    "href": "prediction.html#不透明性-uncertainly",
    "title": "4  予測モデルの推定",
    "section": "4.17 不透明性 (Uncertainly)",
    "text": "4.17 不透明性 (Uncertainly)\n\nデータ分析を含む事例分析の一般的課題\n\n独立した分析チームに同じ市場/社会の分析を依頼したとしても、同じ結論に到達し得ない\n\n誰がやっても、「水は100度で沸騰する」という結論を再現できる理科の実験とは対照的",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#sampling-model-uncertainly",
    "href": "prediction.html#sampling-model-uncertainly",
    "title": "4  予測モデルの推定",
    "section": "4.18 Sampling / Model Uncertainly",
    "text": "4.18 Sampling / Model Uncertainly\n\n観察する事例が人によって異なる (Sampling uncertainly)\n\n伝統的なデータ分析における主たる関心\n\n事例の要約方法(モデル化)が属人的で、不透明 (Model uncertainly)\n\n多くの教科書で直接的な言及を避けてきた問題\n\n「理論や背景をしっかり踏まえて、適切なモデル化を行うべし」以上の提案が難しい",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#sampling-uncertainlyの軽減",
    "href": "prediction.html#sampling-uncertainlyの軽減",
    "title": "4  予測モデルの推定",
    "section": "4.19 Sampling Uncertainlyの軽減",
    "text": "4.19 Sampling Uncertainlyの軽減\n\n問題: データから観察できない価格決定要因の”偏り”が、データ固有の特徴を生み出す\n対策: 多くの事例を集計(モデル化)し、傾向把握を行う\n\n初歩的な方法: よく似た労働者も高賃金を得ているか確認する",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#機械学習の利点",
    "href": "prediction.html#機械学習の利点",
    "title": "4  予測モデルの推定",
    "section": "4.20 機械学習の利点",
    "text": "4.20 機械学習の利点\n\n決定木を含む機械学習の手法は、明確な記述に基づくデータ主導のモデル化を行う\n\nModel Uncertainlyが軽減される",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#機械学習の問題点",
    "href": "prediction.html#機械学習の問題点",
    "title": "4  予測モデルの推定",
    "section": "4.21 機械学習の問題点",
    "text": "4.21 機械学習の問題点\n\nデータ主導のモデル生成は、Sampling uncertainlyを”複雑化”する\n\nデータに応じてモデルが大きく変化しうるため\n\n伝統的な理論的性質(中心極限定理など)が適用できず、信頼区間などが近似計算できない\n\n\\(Y\\) に近い値を得ることが目標である予測問題では、通常大きな問題にならない\nむしろモデル全体の予測性能を評価することが重要",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-決定木",
    "href": "prediction.html#数値例-決定木",
    "title": "4  予測モデルの推定",
    "section": "4.22 数値例: 決定木",
    "text": "4.22 数値例: 決定木\n\n4名の分析者(ID 1-4) が独立してデータを収集し、決定木でモデルを推定したとすると、",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-size-40-で分割",
    "href": "prediction.html#数値例-size-40-で分割",
    "title": "4  予測モデルの推定",
    "section": "4.23 数値例: Size \\(= 40\\) で分割",
    "text": "4.23 数値例: Size \\(= 40\\) で分割\n\n\n\n\n\n\n\n\n\n\nデータとは無関係に、size = 40 で予測値が”誤って”変化する",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#モデルの評価",
    "href": "prediction.html#モデルの評価",
    "title": "4  予測モデルの推定",
    "section": "4.24 モデルの評価",
    "text": "4.24 モデルの評価",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#予測モデルの評価-理想編",
    "href": "prediction.html#予測モデルの評価-理想編",
    "title": "4  予測モデルの推定",
    "section": "4.25 予測モデルの評価: 理想編",
    "text": "4.25 予測モデルの評価: 理想編\n\nどんな予測もまぐれあたりしうる\n\n平均的にうまく行くモデルを採用したい\n\n予測モデルを母分布に適用して評価する: 典型的には二乗誤差の母平均値を用いる \\(E[(Y - g(X))^2]\\)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#予測モデルの評価-現実編",
    "href": "prediction.html#予測モデルの評価-現実編",
    "title": "4  予測モデルの推定",
    "section": "4.26 予測モデルの評価: 現実編",
    "text": "4.26 予測モデルの評価: 現実編\n\n母分布は観察できないので、母分布に適用した際の予測性能は”推定する必要”がある\n\n母分布からランダムに選ばれた事例でテストしたい\n\n最も典型的な評価法は、データ分割: データをランダムに2分割 (訓練/テストデータ)し、訓練データのみでモデルを推定し、テストデータで評価",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#イメージ-2",
    "href": "prediction.html#イメージ-2",
    "title": "4  予測モデルの推定",
    "section": "4.27 イメージ",
    "text": "4.27 イメージ\n\n\n\n\n\n\n\n\n\n\nPopulation\n母集団: 無数の事例 {Y,X}\n\n\n\nOriginal\nデータ\n\n\n\nPopulation-&gt;Original\n\n\nランダム抽出\n\n\n\nData\n訓練データ {Y,X}\n\n\n\nOriginal-&gt;Data\n\n\nランダム分割\n\n\n\nNew\nテストデータ {Y,X}\n\n\n\nOriginal-&gt;New\n\n\n\n\n\nModel\n予測モデル g(X)\n\n\n\nData-&gt;Model\n\n\n\n\n\nNew-&gt;Model\n\n\n\n\n\nPredict\n予測値 Y^*\n\n\n\nModel-&gt;Predict\n\n\n\n\n\nPredict-&gt;New\n\n\nテスト",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#補論-モデルを使い続けられるか",
    "href": "prediction.html#補論-モデルを使い続けられるか",
    "title": "4  予測モデルの推定",
    "section": "4.28 補論: モデルを使い続けられるか?",
    "text": "4.28 補論: モデルを使い続けられるか?\n\nモデル推定に用いるデータの母分布と、予測対象の母分布が異なれば、予測性能は悪化する\n\n高性能モデルでも、時代の変化/大きな社会的ショックの発生等の結果、性能が悪化しうる\n\n通常の設備と同様に、経年劣化/破壊されうる\n\n\n定期的に予測性能を計り直し、再推定する必要がある\n\nConcept-Driftと呼ばれる",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#極端なモデルの推定",
    "href": "prediction.html#極端なモデルの推定",
    "title": "4  予測モデルの推定",
    "section": "4.29 極端なモデルの推定",
    "text": "4.29 極端なモデルの推定\n\n予測モデルの推定の原理を理解するために、極端な推定方法で何が生じるのか理解する",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#理想の予測モデル",
    "href": "prediction.html#理想の予測モデル",
    "title": "4  予測モデルの推定",
    "section": "4.30 理想の予測モデル",
    "text": "4.30 理想の予測モデル\n\nもし母集団をすべて活用して、モデル推定できるのであれば、理想の予測モデルは母平均 \\(E[Y|X]\\)\n\n予測誤差を平均二乗誤差で測定するのが前提\n\n「各グループ内での平均的傾向」よりも優れた予測はあり得ない",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#完璧な予測は可能か",
    "href": "prediction.html#完璧な予測は可能か",
    "title": "4  予測モデルの推定",
    "section": "4.31 完璧な予測は可能か?",
    "text": "4.31 完璧な予測は可能か?\n\n予測不可能な部分 \\(Y - E[Y|X]\\) が発生\n\n削減不可能な誤差\n\n予測対象となる母集団(社会)、\\(Y/X\\) が決まった時点で自動的に定まる\n\n\\(X\\) 内で個人差がある現象の予測は難しい\n\n人間行動やその相互作用で決まる現象 (例: 消費、貯蓄、出生、就業、賃金、等)は大きい傾向",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#予測モデルの推定-現実",
    "href": "prediction.html#予測モデルの推定-現実",
    "title": "4  予測モデルの推定",
    "section": "4.32 予測モデルの推定: 現実",
    "text": "4.32 予測モデルの推定: 現実\n\n母集団は観察できないので、データで置き換える必要がある\n\n単純なモデルを推定すると、母平均の複雑さを捉えられない\n複雑なモデルを推定すると、データが偶然持った特徴を母平均の特徴と混同してしまう",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#現実的な方法-単純平均法",
    "href": "prediction.html#現実的な方法-単純平均法",
    "title": "4  予測モデルの推定",
    "section": "4.33 現実的な方法: 単純平均法",
    "text": "4.33 現実的な方法: 単純平均法\n\n単純な平均取引価格を予測値とする",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#現実的な方法-丸暗記法",
    "href": "prediction.html#現実的な方法-丸暗記法",
    "title": "4  予測モデルの推定",
    "section": "4.34 現実的な方法: 丸暗記法",
    "text": "4.34 現実的な方法: 丸暗記法\n\n各\\(X\\) について、データ上の平均値を予測値とする",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#複雑なモデルは望ましいのか",
    "href": "prediction.html#複雑なモデルは望ましいのか",
    "title": "4  予測モデルの推定",
    "section": "4.35 複雑なモデルは望ましいのか?",
    "text": "4.35 複雑なモデルは望ましいのか?\n\n丸暗記モデルは非常に複雑なモデルを生み出し、望ましいように思える\n\n現実は複雑\n推定に用いたデータとの矛盾はない\n\n予測値とデータ上の平均値は、必ず一致する\n\n\n一般に予測性能は極めて悪い\n\n少数の事例のみで計算れた平均値は、\\(X\\) 以外の決定要因の偏りを反映してしまう",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#補論-丸暗記が有効な場合",
    "href": "prediction.html#補論-丸暗記が有効な場合",
    "title": "4  予測モデルの推定",
    "section": "4.36 補論: 丸暗記が有効な場合",
    "text": "4.36 補論: 丸暗記が有効な場合\n\n\\(X\\) 以外に \\(Y\\) の決定要因がなければ、丸暗記は有効\n\n例: 判例予測、コンピュータの動作予測\n\n人間行動については、\\(X\\) 以外の無数の決定要因が存在\n\n例: “双子”でも違う人生を歩む\n丸暗記に向いていない",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#中庸なモデルの推定",
    "href": "prediction.html#中庸なモデルの推定",
    "title": "4  予測モデルの推定",
    "section": "4.37 中庸なモデルの推定",
    "text": "4.37 中庸なモデルの推定\n\n多くの応用で平均値は単純すぎ、丸暗記は複雑すぎる\n決定木については、最大分割回数などを変更することで、単純平均と丸暗記法の間を移行できる",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#モデル選択集計",
    "href": "prediction.html#モデル選択集計",
    "title": "4  予測モデルの推定",
    "section": "4.38 モデル選択/集計",
    "text": "4.38 モデル選択/集計\n\n決定木の深さが異なれば、予測モデルは異なる\n複数のモデルを”試作”し、予測性能を測定、最も性能が良いモデルを選ぶのは一つの方法\n決定木については、複数のモデルを試作し、その予測結果を集計することがより有効な場合が多い\n\nモデル集計/アンサンブル法などと呼ばれる",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#概要",
    "href": "prediction.html#概要",
    "title": "4  予測モデルの推定",
    "section": "4.39 概要",
    "text": "4.39 概要\n\n複雑なモデルを推定すると、母平均から大きく乖離した事例(ハズレ値)の影響を強く受ける\n\n予測結果を安定されるために、大量の予測モデルを作り、その平均値を最終予測とすることが有効 (Bagging)\n一部の変数の使用を確率的に禁止することも併用できる (RandomForest)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#イメージ-bagging",
    "href": "prediction.html#イメージ-bagging",
    "title": "4  予測モデルの推定",
    "section": "4.40 イメージ: Bagging",
    "text": "4.40 イメージ: Bagging\n\nBootstrap法を用いて、予測モデルを大量に作る (500-5000個程度)\n\n\n\n\n\n\n\n\n\n\n\nData\n訓練データ\n[Y={10,2,4},X={5,7,1}]\n\n\n\nBoot1\n複製データ1\n[Y={2,2,4},X={7,7,1}]\n\n\n\nData-&gt;Boot1\n\n\n\n\n\nBoot2\n複製データ2\n[Y={10,2,2},X={5,7,7}]\n\n\n\nData-&gt;Boot2\n\n\n\n\n\nBoot3\n複製データ3\n[Y={10,10,4},X={5,5,1}]\n\n\n\nData-&gt;Boot3\n\n\n\n\n\nModel1\n予測モデル1 \ng1(X)\n\n\n\nBoot1-&gt;Model1\n\n\n\n\n\nModel2\n予測モデル2 \ng2(X)\n\n\n\nBoot2-&gt;Model2\n\n\n\n\n\nModel3\n予測モデル3 \ng3(X)\n\n\n\nBoot3-&gt;Model3\n\n\n\n\n\nSummary\n平均\n\n\n\nModel1-&gt;Summary\n\n\n\n\n\nModel2-&gt;Summary\n\n\n\n\n\nModel3-&gt;Summary\n\n\n\n\n\nPrediction\n最終予測\n\n\n\nSummary-&gt;Prediction",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#randomforest-の利点",
    "href": "prediction.html#randomforest-の利点",
    "title": "4  予測モデルの推定",
    "section": "4.41 RandomForest の利点",
    "text": "4.41 RandomForest の利点\n\nBootstrapは、“ハズレ値”を含まないデータとそれを用いたモデルも生成される\n\nハズレ値の影響を軽減できる\n\n変数の一部を確率的に使用できなくすることで、モデル間で用いる変数の多様性が促進される\n\nより多くの変数の情報が活用できる\n\n注: 実際にはモデル単位ではなく、サンプル分割ごとに、(元々の変数数のsquare root個)ランダムに使用禁止する",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-random-forest",
    "href": "prediction.html#数値例-random-forest",
    "title": "4  予測モデルの推定",
    "section": "4.42 数値例: Random Forest",
    "text": "4.42 数値例: Random Forest",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#big-dataは優れた予測モデルを保証するか",
    "href": "prediction.html#big-dataは優れた予測モデルを保証するか",
    "title": "4  予測モデルの推定",
    "section": "4.43 Big dataは優れた予測モデルを保証するか?",
    "text": "4.43 Big dataは優れた予測モデルを保証するか?\n\n「Big data \\(=\\) サンプルサイズが多い」、のであれば、完璧な予測モデル \\(g(X) = Y\\) を保証しない\n\n削減不可能な誤差 \\(Y - E[Y|X]\\) が存在するため\n\n理想的な予測モデル \\(g(X) = E[Y|X]\\) は保証できるか?\n\n伝統的な方法 \\(=\\) 極めて強い仮定のもとでのみ可能\n多くの機械学習 \\(=\\) 緩やかな仮定で可能",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-伝統的アプローチ5000事例",
    "href": "prediction.html#数値例-伝統的アプローチ5000事例",
    "title": "4  予測モデルの推定",
    "section": "4.44 数値例: 伝統的アプローチ(5000事例)",
    "text": "4.44 数値例: 伝統的アプローチ(5000事例)\n\n研究者が、「Size \\(= 40\\) で分割する」と決定\n\n推定されうるモデルを限定する",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#数値例-random-forest-with-large-sample-5000事例",
    "href": "prediction.html#数値例-random-forest-with-large-sample-5000事例",
    "title": "4  予測モデルの推定",
    "section": "4.45 数値例: Random Forest with large sample (5000事例)",
    "text": "4.45 数値例: Random Forest with large sample (5000事例)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#まとめ",
    "href": "prediction.html#まとめ",
    "title": "4  予測モデルの推定",
    "section": "4.46 まとめ",
    "text": "4.46 まとめ\n\n実際/理想/完璧な予測モデルの区別が重要\n理想の予測モデル: \\(g(X)=E[Y|X]\\)\n\n個人差があれば、完璧な予測 \\(g(X)=Y\\) は不可能\n\n限られたデータから推定されたモデルは、理想の予測モデルとはならない \\(g(X)\\neq E[Y|X]\\)\n\n機械学習を用いて、近づけることは可能\n\n予測に使う前に、テストデータを用いた性能調査が必須",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "prediction.html#reference",
    "href": "prediction.html#reference",
    "title": "4  予測モデルの推定",
    "section": "4.47 Reference",
    "text": "4.47 Reference",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>予測モデルの推定</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html",
    "href": "simplecomparison.html",
    "title": "5  単純な比較分析",
    "section": "",
    "text": "5.1 実例",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html#実例",
    "href": "simplecomparison.html#実例",
    "title": "5  単純な比較分析",
    "section": "",
    "text": "１年前と比べた労働市場/社会の状況変化\n雇用形態間の所得格差\n\n\n5.1.1 OLS\n\n\n\n\n\n\n\n\n\n\nX\nD\n\n\n\nf_Y\n「未知の」メカニズム\n\n\n\nX-&gt;f_Y\n\n\n\n\n\ng_Y\nシンプルなモデル\n\n\n\nX-&gt;g_Y\n\n\n\n\n\nY\nY\n\n\n\nf_Y-&gt;Y\n\n\n\n\n\nf_Y-&gt;g_Y\n\n\n特徴を反映\n\n\n\ng_Y-&gt;Y\n\n\n\n\n\nEst\n推定\n\n\n\ng_Y-&gt;Est",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html#平均の比較",
    "href": "simplecomparison.html#平均の比較",
    "title": "5  単純な比較分析",
    "section": "5.2 平均の比較",
    "text": "5.2 平均の比較\n\n２種類の方法が考えられる\n\n“Yの特徴を調べる”: \\(D=1/0\\) それぞれについて、\\(Y\\) の平均値を計算し、差をとる\n\nデータと推定結果の関連性について近似的な性質(中心極限定理 など)が成り立つ\n信頼区間が計算でき、強く推奨\n\n“予測モデルの特徴を調べる”: \\(D=1/0\\) それぞれについて、予測値の平均値を計算し、差をとる\n\nデータと推定結果の関連性が複雑で、Blackbox\nバイアスが生じ、信頼区間の計算も難しく、非推奨",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html#信頼区間",
    "href": "simplecomparison.html#信頼区間",
    "title": "5  単純な比較分析",
    "section": "5.3 信頼区間",
    "text": "5.3 信頼区間\n\nデータ上の(単純)平均値であったとしても、データの偶然の偏り(Sampling Uncertainly)の影響を受ける\n\n一般に、データから得た推定値 \\(\\neq\\) 母平均\n\n信頼区間 \\(=\\) 一定の確率(多くの初期設定で 95 \\(\\%\\)) で、母平均を含む区間\n\n\\(Y\\) の平均値を推定値とするのであれば、事例数がある程度大きい (\\(\\simeq\\) 200 以上)であれば、近似計算が可能\n\\(Y\\) の予測値の平均値を用いる場合、計算方法が確立されていない\n\n\n\n5.3.1 信頼区間の重要性\n\nマクロな意思決定は、取り返しがつかない/幅広い層に影響を与えるものが多い\n判断材料となる情報にも、高い信頼性/透明性が求められる\n\nSampling Uncertainlyのせいで、点推定値は “100\\(\\%\\)” 間違えている\n\nとくに少数グループについて、母平均からかけ離れた値が推定されがち\n“推定誤差” を常に考慮する必要がある",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html#まとめ",
    "href": "simplecomparison.html#まとめ",
    "title": "5  単純な比較分析",
    "section": "5.4 まとめ",
    "text": "5.4 まとめ\n\nある程度の事例数を活用し、シンプルな平均値やその差を推定したのであれば、計量経済学の入門書で紹介される「平均値の推定」法が実用的\n\n事例数が非常に少ないケース (30以下など)であれば、ベイズ法なども有力",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "simplecomparison.html#補論-統計モデルの推定",
    "href": "simplecomparison.html#補論-統計モデルの推定",
    "title": "5  単純な比較分析",
    "section": "5.5 補論: 統計モデルの推定",
    "text": "5.5 補論: 統計モデルの推定\n\n平均差による母平均の差の推定結果は、以下の母平均のモデルをOLSで推定した結果と一致する \\[Y=\\beta_0 + \\underbrace{\\beta_1}_{=E[Y|D=1] - E[Y|D=0]}D + \\underbrace{u}_{E[u|D=1]=E[u|D=0]=0}\\]\n\n\\(\\beta_1=\\) Parameter of interest\n\n「母集団の信頼できる統計モデルのパラメタを推定する」方法として、教科書では紹介されてきた\n\n研究関心が複雑になると信頼できるモデルを構築するのが難しくなる",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>単純な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html",
    "href": "complexcomparison.html",
    "title": "6  複雑な比較分析",
    "section": "",
    "text": "6.1 アプローチ",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#アプローチ",
    "href": "complexcomparison.html#アプローチ",
    "title": "6  複雑な比較分析",
    "section": "",
    "text": "伝統的には、重回帰分析を用いた分析 \\(Y\\sim D + X_1+..\\) が行われてきた\n\n今でも有効だが、モデルの定式化に結果が依存してしまう問題がある\n\n機械学習とOLSの併用が有効\n\nTarget/Debiased learning(Van der Laan, Rose, et al. 2011; Chernozhukov et al. 2018, 2022)\n\nCausalMLBookの1,4,10章に相当",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#変化の分解",
    "href": "complexcomparison.html#変化の分解",
    "title": "6  複雑な比較分析",
    "section": "6.2 変化の分解",
    "text": "6.2 変化の分解\n\n\\(E[Y|D=1] - E[Y|D=0] = Y\\) の平均値の差\n通常、 \\(Y\\) 以外の変数 \\(X\\) についても、\\(D\\) 間で差が存在する\n\\(X\\) について差がなかった(バランスさせた)場合に、 \\(Y\\) についてどの程度差が存在するのか \\(?\\)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#例.-出生率",
    "href": "complexcomparison.html#例.-出生率",
    "title": "6  複雑な比較分析",
    "section": "6.3 例. 出生率",
    "text": "6.3 例. 出生率\n\n出生の動向を把握する上で、新生児数を年次比較する\n\n成人の年齢構造の変化を無視している\n\n50年前よりも、高齢者の比率が高い\n\n\n合計特殊出生率\n\n「年齢構造が同じであった場合の」出生率はどのように変化を議論できる\n\n学歴や家族構成などもバランスさせることは可能か？",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#例.-既存店ベースの比較",
    "href": "complexcomparison.html#例.-既存店ベースの比較",
    "title": "6  複雑な比較分析",
    "section": "6.4 例. 既存店ベースの比較",
    "text": "6.4 例. 既存店ベースの比較\n\nあるコンビニチェーンで、店舗あたりの平均売り上げが1000万円増大した \\[E[Y|D=1] - E[Y|D=0]= 1000万円\\]\n去年から今年にかけて、新規出店が大きく増加した\n\n売り上げが大きくなる傾向のある新規店の割合が大きく、結果、平均売り上げが増大したのではないか?\n\n既存店 (\\(=X\\)) に絞って、比較する",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#例.-客層",
    "href": "complexcomparison.html#例.-客層",
    "title": "6  複雑な比較分析",
    "section": "6.5 例. 客層",
    "text": "6.5 例. 客層\n\nあるコンビニチェーンで、大手町店と本郷三丁目店で、客単価が大きく異なる\n\n客層の違いに起因しているのではないか?\n\n本郷三丁目の方が、大学生が多い等\n\n\n来客の年齢や職業 (\\(=X\\)) の分布を仮想的に揃えて、比較する",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#例.-因果推論",
    "href": "complexcomparison.html#例.-因果推論",
    "title": "6  複雑な比較分析",
    "section": "6.6 例. 因果推論",
    "text": "6.6 例. 因果推論\n\nコンビニの改装が平均的にどの程度、平均売上を上昇させるのか\n\n「改装するかどうかの意思決定、および価格に影響を与える変数」(Confounders)が\\(D\\)間で偏る\nデータから観察できる Confoundersについては、分布を揃える必要がある\n(発展) 観察できないConfoundersへの対処は?\n\n統計的因果推論にて多くの議論が蓄積",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#理想的な推定方法",
    "href": "complexcomparison.html#理想的な推定方法",
    "title": "6  複雑な比較分析",
    "section": "6.7 理想的な推定方法",
    "text": "6.7 理想的な推定方法\n\n全ての\\(X\\)の組み合わせについて、平均差 \\(E[Y|D=1,X] - E[Y|D=0,X]\\) を計算する\n\n\\(X\\) の値が一致している事例内で比較\n\n問題点: \\(X\\) の組み合わせが増えると、サブグループ内での事例数が極端に小さくなり、実行不可能\n\n多くの応用で非現実的",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#residual-learner",
    "href": "complexcomparison.html#residual-learner",
    "title": "6  複雑な比較分析",
    "section": "6.8 R(esidual)-learner",
    "text": "6.8 R(esidual)-learner\n\n\\(X\\) を \\(D\\) 間でバランスさせた元での比較を行うために、以下の手順を実行する\n\n\nデータを2分割する (訓練/テスト)\n訓練データを用いて、\\(X\\) から \\(Y/D\\) を予測するモデル \\(g_Y(X)/g_D(X)\\) を推定する\nテストデータを用いて、\\(Y/D\\)の予測誤差をOLSで回帰し係数 \\(\\beta_D\\) を推定値とする \\[Y-g_Y(X)\\sim D - g_D(X)\\]\n\n\n後日、より効率的なサンプル分割方法(交差推定)を紹介",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#直感",
    "href": "complexcomparison.html#直感",
    "title": "6  複雑な比較分析",
    "section": "6.9 直感",
    "text": "6.9 直感\n\n\\(X\\) の偏りを排除したい\n\n\n\n\n\n\n\n\n\n\n\nY\nY\n\n\n\nD\nD\n\n\n\nY-&gt;D\n\n\n\n\n\nf_Y\nblackbox\n\n\n\nY-&gt;f_Y\n\n\n\n\n\nY-&gt;f_Y\n\n\n\n\n\nX\nX\n\n\n\nf_D\nblackbox\n\n\n\nX-&gt;f_D\n\n\n\n\n\nX-&gt;f_D\n\n\n\n\n\nf_Y-&gt;X\n\n\n\n\n\nf_Y-&gt;X\n\n\n\n\n\nf_D-&gt;D\n\n\n\n\n\nf_D-&gt;D",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#直感-1",
    "href": "complexcomparison.html#直感-1",
    "title": "6  複雑な比較分析",
    "section": "6.10 直感",
    "text": "6.10 直感\n\n予測モデルにより、\\(X\\) の偏りの影響を評価する\n\n\n\n\n\n\n\n\n\n\n\nY\nY\n\n\n\nf_Y\nblackbox\n\n\n\nY-&gt;f_Y\n\n\n\n\n\nY-&gt;f_Y\n\n\n\n\n\nD\nD\n\n\n\nX\nX\n\n\n\nf_D\nblackbox\n\n\n\nX-&gt;f_D\n\n\n\n\n\nX-&gt;f_D\n\n\n\n\n\nf_Y-&gt;X\n\n\n\n\n\nf_Y-&gt;X\n\n\n\n\n\ng_Y\ng_Y(X)\n\n\n\nf_Y-&gt;g_Y\n\n\n置き換え\n\n\n\nf_D-&gt;D\n\n\n\n\n\nf_D-&gt;D\n\n\n\n\n\ng_D\ng_D(X)\n\n\n\nf_D-&gt;g_D\n\n\n置き換え",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#例-基本アイディア",
    "href": "complexcomparison.html#例-基本アイディア",
    "title": "6  複雑な比較分析",
    "section": "6.11 例: 基本アイディア",
    "text": "6.11 例: 基本アイディア\n\n事例1と４の間で、\\(700\\) 万円近くの 以上の価格格差\n\\(X\\) が大きく異なる\n\n(\\(X\\) からの)予測値についても、同程度の格差\n\n実際の格差から、(\\(X\\)の影響を捉える) 予測値の差を引くと ほとんど格差はない",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#直感-2",
    "href": "complexcomparison.html#直感-2",
    "title": "6  複雑な比較分析",
    "section": "6.12 直感",
    "text": "6.12 直感\n\n価格 \\(=\\) 取引年 \\(+\\) \\(X\\) の影響 \\(+\\) その他\n予測モデルが\\(X\\) の影響を完全に捉え、その他の影響がなければ、 \\[\\underbrace{Y_1 - Y_2}_{事例1と2の賃金格差}-\\underbrace{g_Y(X_1) - g_Y(X_2)}_{予測格差}\\] \\[=\\underbrace{Y_1 - g_Y(X_1)}_{1についての予測誤差} - \\underbrace{(Y_2 - g_Y(X_2))}_{2についての予測誤差}\\] は、バランス後の賃金格差を捉える",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#直感-3",
    "href": "complexcomparison.html#直感-3",
    "title": "6  複雑な比較分析",
    "section": "6.13 直感",
    "text": "6.13 直感\n\nその他の影響は、当然存在する\n個別事例について、影響を排除することは困難\n大量の事例の平均をとることで、平均格差を明らかにする \\[\\underbrace{E[Y - g_Y(X)|D=1]}_{D=1についての平均予測誤差} - \\underbrace{E[Y - g_Y(X)|D=0]}_{D=0についての平均予測誤差}\\]\n\\(g_Y(X)=E[Y|X]\\) であれば、バランス後の平均格差の優れた推定値",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#直感-4",
    "href": "complexcomparison.html#直感-4",
    "title": "6  複雑な比較分析",
    "section": "6.14 直感",
    "text": "6.14 直感\n\n限られた事例から推定された予測モデルは、理想的なものと乖離する: \\(g_Y(X)\\neq E[Y|X]\\)\n\n格差の推定値に、予測困難な悪影響を与える\n\n\\(D\\) の予測モデル \\(g_D(X)\\) も併用する\n\n\\(X\\) が \\(D\\) に与える影響も極力排除する\n\n\\(Y\\) の予測誤差 \\(Y-g_Y(X)\\) を \\(D\\) の予測誤差 \\(D-g_D(X)\\) で回帰する",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#double-debaised-machine-learning",
    "href": "complexcomparison.html#double-debaised-machine-learning",
    "title": "6  複雑な比較分析",
    "section": "6.15 Double Debaised Machine Learning",
    "text": "6.15 Double Debaised Machine Learning\n\nR learnerは、Double/Debiased Machine Learningと呼ばれる手法の一つ\n最終的にはOLSや平均値などで推定する\n\n予測モデルの不完全性 (AIのミス) の悪影響を、複数の予測モデルを組み合わせることで減らす\n予測モデルが同時に母平均から大きく乖離しなければOK (“AIによるDouble Check”)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#推定値の性質",
    "href": "complexcomparison.html#推定値の性質",
    "title": "6  複雑な比較分析",
    "section": "6.16 推定値の性質",
    "text": "6.16 推定値の性質\n\n\\(g_Y(X),g_D(X)\\) が \\(E[Y|X],E[D|X]\\) をある程度近似できるのであれば (後述)、近似的な信頼区間を計算可能\n\n十分な事例数 (私見では500事例以上)\n適した推定方法の採用 (後日議論)\n\n注: \\(Y,D\\) を高い精度で予測する必要はない\n\n個人差が大きく予測しにくい現象であったとしても、比較分析への活用においては、予測モデルは有益",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#補論-olsとの比較",
    "href": "complexcomparison.html#補論-olsとの比較",
    "title": "6  複雑な比較分析",
    "section": "6.17 補論: OLSとの比較",
    "text": "6.17 補論: OLSとの比較\n\n「\\(X\\) の分布を均した後の比較」を行う伝統的方法は、以下のモデルを重回帰する \\[E[Y|D,X]=\\beta_0 + \\beta_D D + \\beta_1X_1+...\\]\nFWL定理 (wiki)より、R-leanerの特殊ケースと見做せる",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#補論-olsとの比較-1",
    "href": "complexcomparison.html#補論-olsとの比較-1",
    "title": "6  複雑な比較分析",
    "section": "6.18 補論: OLSとの比較",
    "text": "6.18 補論: OLSとの比較\n\nFWL定理より、OLSの推定結果 \\(\\beta_D\\) は、以下の手順により得られる推定結果と一致\n\n\n全データ を用いて、 OLS で予測モデル \\(g_Y(X)=\\beta_0 + \\beta_1X_1+..., g_D(X)=\\alpha_0+\\alpha_1X_1+..\\) を推定\n以下はR-learnerと同じ手順\n\n\n予測モデルの定式化が正しく、かつ事例数に比べて十分に単純 (\\(\\beta\\) の数が少ない)のであれば、優れた推定方法だが、そうではない応用例も多い",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#補論-統計モデルとしての書き換え",
    "href": "complexcomparison.html#補論-統計モデルとしての書き換え",
    "title": "6  複雑な比較分析",
    "section": "6.19 補論: 統計モデルとしての書き換え",
    "text": "6.19 補論: 統計モデルとしての書き換え\n\nR-learnerの推定結果は、以下のモデルを推定した場合の結果と一致 (Robinson 1988) \\[Y=\\tau D + \\underbrace{f(X)}_{何らかの(blackboxな)関数} + \\underbrace{u}_{E[u|D,X]=0}\\]\n\n教科書的な線形モデル: 「\\(f(X)=\\beta_0 + \\beta_1X_1 +..\\) と特定化しても \\(E[u|D,X]=0\\) が成り立つ」という仮定を追加",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#まとめ",
    "href": "complexcomparison.html#まとめ",
    "title": "6  複雑な比較分析",
    "section": "6.20 まとめ",
    "text": "6.20 まとめ\n\nシンプルな比較分析であれば、伝統的な推定方法が有効\n複雑な比較分析、ここでは \\(X\\) をバランスさせた後での比較、においては機械学習も併用することで、分析の信頼性を改善できる\n\nOLSなどと比べて、推定結果が大きく変わらなかったとしても、分析の頑強性の確認ができる",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  },
  {
    "objectID": "complexcomparison.html#reference",
    "href": "complexcomparison.html#reference",
    "title": "6  複雑な比較分析",
    "section": "6.21 Reference",
    "text": "6.21 Reference\n\n\n\n\nChernozhukov, Victor, Denis Chetverikov, Mert Demirer, Esther Duflo, Christian Hansen, Whitney Newey, and James Robins. 2018. “Double/debiased machine learning for treatment and structural parameters.” The Econometrics Journal 21 (1): C1–68. https://doi.org/10.1111/ectj.12097.\n\n\nChernozhukov, Victor, Juan Carlos Escanciano, Hidehiko Ichimura, Whitney K Newey, and James M Robins. 2022. “Locally Robust Semiparametric Estimation.” Econometrica 90 (4): 1501–35.\n\n\nRobinson, Peter M. 1988. “Root-n-Consistent Semiparametric Regression.” Econometrica: Journal of the Econometric Society, 931–54.\n\n\nVan der Laan, Mark J, Sherri Rose, et al. 2011. Targeted Learning: Causal Inference for Observational and Experimental Data. Vol. 4. Springer.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>複雑な比較分析</span>"
    ]
  }
]